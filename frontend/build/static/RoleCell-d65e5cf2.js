import{g5 as ne,c as te,j as e,X as N,d as l,E as O,aa as oe,ca as se,ac as ae,y as S,C,B as k,an as re,d7 as le,a4 as ie,a5 as ce,a6 as de,a7 as ue,am as K,bK as z,au as he,dl as pe,bQ as me,g6 as ye,s as p,aJ as $,dD as fe,a9 as I,dE as w,r as h,a8 as be,ab as R,d2 as Ce,du as ge,a1 as P,a2 as Te,f as q,aH as V,cq as Ae,g7 as ke,de as Se,b6 as Q,h as Ee,dn as ve,c8 as Ie,i as Ne,ao as J,g8 as A,cO as xe,fp as W,cM as De,cN as we,T as B,d_ as Re,F as Pe,e0 as Be,cV as Oe,e1 as _e,fl as Le,aM as Fe,aN as je,aO as Me,A as Ue,l as He,dU as X,b9 as Ke,ba as We,bb as Ge,by as ze}from"./index-4f80e427.js";const $e=ne(),An=$e,qe=te(e("path",{d:"M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04L21 10zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"}),"Key"),Ve=()=>{const{uiConfig:n}=N();return l(O,{severity:"info",children:[l("p",{children:["Read the"," ",e("a",{href:"https://docs.getunleash.io/reference/sdks",target:"_blank",rel:"noreferrer",children:"SDK overview"})," ","to connect Unleash to your application. Please note it can take up to ",e("strong",{children:"1 minute"})," before a new API key is activated."]}),e("br",{}),e("strong",{children:"API URL: "})," ",l("pre",{style:{display:"inline"},children:[n.unleashUrl,"/api/"]})]})},Qe=["Icon","createdAt"],Je=["Icon","project","seenAt"],kn=({compact:n=!1,setHiddenColumns:t,columns:s,loading:o,rows:a,getTableProps:i,getTableBodyProps:r,headerGroups:u,globalFilter:m,prepareRow:b})=>{const g=oe(se.breakpoints.down("md"));return ae([{condition:g,columns:Qe},{condition:n,columns:Je}],t,s),l(S,{children:[e(C,{condition:a.length>0,show:e(k,{sx:{mb:4},children:e(Ve,{})})}),e(k,{sx:{overflowX:"auto"},children:e(re,{value:m,children:l(le,{...i(),children:[e(ie,{headerGroups:u}),e(ce,{...r(),children:a.map(f=>(b(f),e(de,{hover:!0,...f.getRowProps(),children:f.cells.map(y=>e(ue,{...y.getCellProps(),children:y.render("Cell")}))})))})]})})}),e(C,{condition:a.length===0&&!o,show:e(C,{condition:(m==null?void 0:m.length)>0,show:l(K,{children:["No tokens found matching “",m,"”"]}),elseShow:e(K,{children:l("span",{children:["No tokens available. Read ",e(z,{href:"https://docs.getunleash.io/how-to/api",target:"_blank",rel:"noreferrer",children:"API How-to guides"})," "," to learn more."]})})})})]})},Sn=({path:n,permission:t,project:s})=>{const o=he();return e(pe,{Icon:me,onClick:()=>o(n),"data-testid":ye,permission:t,projectId:s,maxWidth:"700px",children:"New API token"})},Xe=p($)(({theme:n})=>({textDecoration:"none",color:n.palette.links,"&:hover, &:focus":{textDecoration:"underline"}})),Ye=({projects:n,project:t})=>{const{searchQuery:s}=fe();let o=n&&Array.isArray(n)?n:t?[t]:[];return o.length===0?e(I,{children:e(w,{search:s,children:"*"})}):e(I,{children:o.map((a,i)=>l(h.Fragment,{children:[i>0&&", ",!a||a==="*"?e(w,{search:s,children:"*"}):e(Xe,{to:`/projects/${a}`,children:e(w,{search:s,children:a})})]},a))})},En=(n,t)=>{const s=h.useMemo(()=>({sortBy:[{id:"createdAt"}]}),[]),o=h.useMemo(()=>[{id:"Icon",width:"1%",Cell:()=>e(be,{icon:e(qe,{color:"disabled"})}),disableSortBy:!0,disableGlobalFilter:!0},{Header:"Username",accessor:"username",Cell:R},{Header:"Type",accessor:"type",Cell:({value:y})=>e(R,{value:G[y.toLowerCase()].label,subtitle:G[y.toLowerCase()].title}),minWidth:280},{Header:"Project",accessor:"project",Cell:y=>e(Ye,{project:y.row.original.project,projects:y.row.original.projects}),minWidth:120},{Header:"Environment",accessor:"environment",Cell:R,minWidth:120},{Header:"Created",accessor:"createdAt",Cell:Ce,minWidth:150,disableGlobalFilter:!0},{Header:"Last seen",accessor:"seenAt",Cell:ge,minWidth:150,disableGlobalFilter:!0},{Header:"Actions",id:"Actions",align:"center",width:"1%",disableSortBy:!0,disableGlobalFilter:!0,Cell:t}],[]),{getTableProps:a,getTableBodyProps:i,headerGroups:r,rows:u,prepareRow:m,state:b,setGlobalFilter:g,setHiddenColumns:f}=P.useTable({columns:o,data:n,initialState:s,sortTypes:Te,autoResetHiddenColumns:!1,disableSortRemove:!0},P.useGlobalFilter,P.useSortBy);return{getTableProps:a,getTableBodyProps:i,headerGroups:r,rows:u,prepareRow:m,state:b,setGlobalFilter:g,setHiddenColumns:f,columns:o}},G={client:{label:"CLIENT",title:"Connect server-side SDK or Unleash Proxy"},frontend:{label:"FRONTEND",title:"Connect web and mobile SDK"},admin:{label:"ADMIN",title:"Full access for managing Unleash"}},vn=({token:n,project:t,permission:s,track:o})=>{const{setToastData:a}=q(),i=r=>{ke(r)&&(a({type:"success",title:"Token copied to clipboard"}),o&&typeof o=="function"&&o())};return e(V,{permission:s,projectId:t,tooltipProps:{title:"Copy token",arrow:!0},onClick:()=>i(n.secret),size:"large",children:e(Ae,{})})},Ze=p("ul")({marginBottom:0}),In=({token:n,permission:t,onRemove:s,project:o})=>{const[a,i]=h.useState(!1),{setToastData:r,setToastApiError:u}=q();return l(S,{children:[e(V,{permission:t,projectId:o,tooltipProps:{title:"Delete token",arrow:!0},onClick:()=>i(!0),size:"large",children:e(Se,{})}),e(Q,{open:a,onClick:async()=>{try{await s(),i(!1),r({type:"success",title:"API token removed"})}catch(b){u(Ee(b))}},onClose:()=>i(!1),title:"Confirm deletion",children:l("div",{children:["Are you sure you want to delete the following API token?",e("br",{}),l(Ze,{children:[l("li",{children:[e("strong",{children:"username"}),":"," ",e("code",{children:n.username})]}),l("li",{children:[e("strong",{children:"type"}),": ",e("code",{children:n.type})]})]})]})})]})},en=p("div")(()=>({maxWidth:"400px"})),nn=p("form")(()=>({display:"flex",flexDirection:"column",height:"100%"})),tn=p(ve)(({theme:n})=>({width:"100%",marginBottom:n.spacing(2)})),on=p(Ie)(({theme:n})=>({marginBottom:n.spacing(2),minWidth:"400px",[n.breakpoints.down("sm")]:{minWidth:"379px"}})),Y=p("p")(({theme:n})=>({marginBottom:n.spacing(1)})),sn=p("label")(({theme:n})=>({marginBottom:n.spacing(1)})),an=p(Ne)(({theme:n})=>({marginLeft:n.spacing(3)})),rn=p(k)({marginTop:"auto",display:"flex",justifyContent:"flex-end"}),Nn=({children:n,actions:t,handleSubmit:s,handleCancel:o})=>{var r;const{uiConfig:a}=N(),i=!!((r=a==null?void 0:a.flags)!=null&&r.UNLEASH_CLOUD);return l(nn,{onSubmit:s,children:[e(C,{condition:i,show:l(O,{severity:"info",sx:{mb:4},children:["Please be aware of our"," ",e(z,{href:"https://www.getunleash.io/fair-use-policy",children:"fair use policy"}),"."]})}),n,l(rn,{children:[t,e(an,{onClick:o,children:"Cancel"})]})]})};var d=(n=>(n.ADMIN="ADMIN",n.CLIENT="CLIENT",n.FRONTEND="FRONTEND",n))(d||{});const xn=n=>{var M,U;const{environments:t}=J(),{uiConfig:s}=N(),o=(M=t==null?void 0:t.find(c=>c.enabled))==null?void 0:M.name,a=A(xe),i=A(W,n),r=[{key:d.CLIENT,label:`Server-side SDK (${d.CLIENT})`,title:"Connect server-side SDK or Unleash Proxy",enabled:a||i}],u=A(De),m=A(we),b=A(W,n);n||r.push({key:d.ADMIN,label:d.ADMIN,title:"Full access for managing Unleash",enabled:u}),s.flags.embedProxyFrontend&&r.splice(1,0,{key:d.FRONTEND,label:`Client-side SDK (${d.FRONTEND})`,title:"Connect web and mobile SDK directly to Unleash",enabled:m||b});const g=(U=r.find(c=>c.enabled))==null?void 0:U.key,[f,y]=h.useState(""),[E,L]=h.useState(g||d.CLIENT),[T,x]=h.useState([n||"*"]),[Z,ee]=h.useState(T),[F,v]=h.useState(),[j,D]=h.useState({});return h.useEffect(()=>{v(E==="ADMIN"?"*":o)},[E,o]),{username:f,type:E,apiTokenTypes:r,projects:T,environment:F,setUsername:y,setTokenType:c=>{c==="ADMIN"?(L(d.ADMIN),ee(T),x(["*"]),v("*")):(L(c),x(Z),v(o))},setProjects:x,setEnvironment:v,getApiTokenPayload:()=>({username:f,type:E,environment:F,projects:T}),isValid:()=>{const c={};return f||(c.username="Username is required"),T.length===0&&(c.projects="At least one project is required"),D(c),Object.keys(c).length===0},clearErrors:c=>{if(c){const H={...j};delete H[c],D(H)}else D({})},errors:j}},Dn=({open:n,closeConfirm:t,token:s,type:o})=>l(Q,{open:n,onClick:t,primaryButtonText:"Close",title:"New token created",children:[e(B,{variant:"body1",children:"Your new token has been created successfully."}),e(Re,{token:s}),e(C,{condition:o===d.FRONTEND,show:l(O,{sx:{mt:2},severity:"info",children:["By default, all ",d.FRONTEND," tokens may be used from any CORS origin. If you'd like to configure a strict set of origins, please use the"," ",e($,{to:"/admin/cors",target:"_blank",rel:"noreferrer",children:"CORS origins configuration page"}),"."]})})]}),wn=({username:n,setUsername:t,errors:s,clearErrors:o})=>l(S,{children:[e(Y,{children:"What would you like to call this token?"}),e(tn,{value:n,name:"username",onChange:a=>t(a.target.value),label:"Token name",error:s.username!==void 0,errorText:s.username,onFocus:()=>o("username"),autoFocus:!0})]}),Rn=({type:n,setType:t,apiTokenTypes:s})=>e(en,{children:l(Pe,{sx:{mb:2,width:"100%"},children:[e(sn,{id:"token-type",children:"What do you want to connect?"}),e(Be,{"aria-labelledby":"token-type",defaultValue:"CLIENT",name:"radio-buttons-group",value:n,onChange:(o,a)=>t(a),children:s.map(({key:o,label:a,title:i,enabled:r})=>e(Oe,{value:o,sx:{mb:1},disabled:!r,control:e(_e,{sx:{ml:.75,alignSelf:"flex-start"}}),label:e(k,{children:l(k,{children:[e(B,{children:a}),e(B,{variant:"body2",color:"text.secondary",children:i})]})})},o))})]})}),Pn=({type:n,environment:t,setEnvironment:s})=>{const{environments:o}=J(),a=n===d.ADMIN?[{key:"*",label:"ALL"}]:o.map(i=>({key:i.name,label:`${i.name.concat(i.enabled?"":" - deprecated")}`,title:i.name,disabled:!1}));return l(S,{children:[e(Y,{children:"Which environment should the token have access to?"}),e(on,{disabled:n===d.ADMIN,options:a,value:t,onChange:s,label:"Environment",id:"api_key_environment",name:"environment",IconComponent:Le,fullWidth:!0})]})},ln=n=>n.map(t=>({...t.user,joinedAt:new Date(t.joinedAt),createdBy:t.createdBy})),Bn=n=>{const{data:t,error:s,mutate:o}=Fe(je(`api/admin/groups/${n}`),cn);return h.useMemo(()=>({group:t&&{...t,users:ln((t==null?void 0:t.users)??[])},loading:!s&&!t,refetchGroup:()=>o(),error:s}),[t,s,o])},cn=n=>fetch(n).then(Me("Group")).then(t=>t.json()),dn=p("div")(({theme:n})=>({display:"flex",flexDirection:"column","& > span:last-of-type":{fontSize:n.fontSizes.smallerBody,color:n.palette.text.secondary}})),On=({roles:n,value:t,setValue:s,required:o,...a})=>l(S,{children:[e(Ue,{openOnFocus:!0,size:"small",value:t,onChange:(r,u)=>s(u||null),options:n,renderOption:(r,u)=>e("li",{...r,children:l(dn,{children:[e("span",{children:u.name}),e("span",{children:u.description})]})}),getOptionLabel:r=>r.name,renderInput:r=>e(He,{...r,label:"Role",required:o}),...a}),e(C,{condition:!!t,show:()=>e(X,{sx:{marginTop:1},roleId:t.id})})]});var _={},un=We;Object.defineProperty(_,"__esModule",{value:!0});var hn=_.default=void 0,pn=un(Ke()),mn=Ge,yn=(0,pn.default)((0,mn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");hn=_.default=yn;const _n=({roleId:n,value:t})=>{const{isEnterprise:s}=N();return s()?e(I,{children:e(ze,{tooltip:e(X,{roleId:n,tooltip:!0}),children:t})}):e(I,{children:t})};export{kn as A,An as B,Sn as C,Pn as E,In as R,Y as S,d as T,vn as a,xn as b,Nn as c,wn as d,Rn as e,Dn as f,Bn as g,On as h,hn as i,_n as j,ln as m,En as u};
